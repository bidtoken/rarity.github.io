(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[0],{80484:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return I}});var t=n(83789),a=n(30266),s=n(809),o=n.n(s),i=n(27484),c=n.n(i),u=n(84110),l=n.n(u),d=n(67294),f=n(25675),v=n(80160),p=n(87046),x=n(627),m=n(94775),g=n(71637),h=n(96883),E=n(2908),A=n(69125),Z=n(84823),N=n(61583),k=n(80318),C=n(96519);function P(e){v.ZP.dismiss(e),v.ZP.success("Transaction successful")}function w(e){return T.apply(this,arguments)}function T(){return(T=(0,a.Z)(o().mark((function e(r){var n,t,a,s,i,c,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.provider,t=r.steps,s=n.getSigner(),e.next=4,s.getAddress();case 4:return i=e.sent,c=new C.Contract("0x7D9f354e5d942E16EB6cB4c15C2d2e80Ec08bAe6",["function setApprovalForAll(address operator, bool approved) external","function isApprovedForAll(address owner, address operator) external view returns (bool)"],s),e.next=8,c.isApprovedForAll(i,"0x67531697B81A1213f89899FD2e94f21C8ff4a172");case 8:if(!e.sent){e.next=13;break}return e.abrupt("return",[!1,!0]);case 13:return e.prev=13,a=v.ZP.loading("1/".concat(t," - Approving Extended Care...")),e.next=17,c.setApprovalForAll("0x67531697B81A1213f89899FD2e94f21C8ff4a172",!0);case 17:return u=e.sent,e.next=20,u.wait(2);case 20:if(1!==e.sent.status){e.next=26;break}return v.ZP.dismiss(a),e.abrupt("return",[!0,!0]);case 26:return v.ZP.dismiss(a),v.ZP.error("Approve reverted"),e.abrupt("return",[!1,!1]);case 29:e.next=37;break;case 31:return e.prev=31,e.t0=e.catch(13),console.error(e.t0),v.ZP.dismiss(a),v.ZP.error("Approve reverted"),e.abrupt("return",[!1,!1]);case 37:case"end":return e.stop()}}),e,null,[[13,31]])})))).apply(this,arguments)}function D(e,r){return b.apply(this,arguments)}function b(){return(b=(0,a.Z)(o().mark((function e(r,n){var t,a,s,i,c,u,l,d,f,p,x=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.provider,a=r.tokensID,s=x.length>2&&void 0!==x[2]?x[2]:P,e.next=4,w({provider:t,steps:2});case 4:if(i=e.sent,c=(0,k.Z)(i,2),u=c[0],c[1]){e.next=13;break}return v.ZP.dismiss(l),v.ZP.error("Approve reverted"),n({error:!0,data:void 0}),e.abrupt("return");case 13:return l=u?v.ZP.loading("2/2 - Taking care of your adventurers..."):v.ZP.loading("Taking care of your adventurers..."),d=t.getSigner(),f=new C.Contract("0x67531697B81A1213f89899FD2e94f21C8ff4a172",["function care_of(uint[] memory _summoners, bool[4] memory _whatToDo, uint _threshold_cellar) external"],d),e.prev=16,e.next=19,f.care_of(a,[!0,!0,!0,!0],1);case 19:return p=e.sent,e.next=22,p.wait(2);case 22:1===e.sent.status?s(l):(v.ZP.dismiss(l),v.ZP.error("Transaction reverted"),n({error:!0,data:void 0})),e.next=32;break;case 26:e.prev=26,e.t0=e.catch(16),console.error(e.t0),v.ZP.dismiss(l),v.ZP.error("Something went wrong, please try again later."),n({error:e.t0,data:void 0});case 32:case"end":return e.stop()}}),e,null,[[16,26]])})))).apply(this,arguments)}function L(){return(L=(0,a.Z)(o().mark((function e(r,n){var t,a,s,i,c,u,l,d,f,p,x=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.provider,a=r.tokensID,s=x.length>2&&void 0!==x[2]?x[2]:P,e.next=4,w({provider:t,steps:2});case 4:if(i=e.sent,c=(0,k.Z)(i,2),u=c[0],c[1]){e.next=12;break}return v.ZP.error("Approve reverted"),n({error:!0,data:void 0}),e.abrupt("return");case 12:return l=u?v.ZP.loading("2/2 - Sending adventurers in an adventure..."):v.ZP.loading("Sending adventurers in an adventure..."),d=t.getSigner(),f=new C.Contract("0x67531697B81A1213f89899FD2e94f21C8ff4a172",["function adventure(uint[] memory _summoners) external"],d),e.prev=15,e.next=18,f.adventure(a);case 18:return p=e.sent,e.next=21,p.wait(2);case 21:1===e.sent.status?s(l):(v.ZP.dismiss(l),v.ZP.error("Transaction reverted"),n({error:!0,data:void 0})),e.next=31;break;case 25:e.prev=25,e.t0=e.catch(15),console.error(e.t0),v.ZP.dismiss(l),v.ZP.error("Something went wrong, please try again later."),n({error:e.t0,data:void 0});case 31:case"end":return e.stop()}}),e,null,[[15,25]])})))).apply(this,arguments)}function O(){return(O=(0,a.Z)(o().mark((function e(r,n){var t,a,s,i,c,u,l,d,f,p,x=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.provider,a=r.tokensID,s=x.length>2&&void 0!==x[2]?x[2]:P,e.next=4,w({provider:t,steps:2});case 4:if(i=e.sent,c=(0,k.Z)(i,2),u=c[0],c[1]){e.next=12;break}return v.ZP.error("Approve reverted"),n({error:!0,data:void 0}),e.abrupt("return");case 12:return l=u?v.ZP.loading("2/2 - Sending adventurers in the Cellar adventurers..."):v.ZP.loading("Sending adventurers in the Cellar adventurers..."),d=t.getSigner(),f=new C.Contract("0x67531697B81A1213f89899FD2e94f21C8ff4a172",["function adventure_cellar(uint[] memory _summoners, uint _threshold) external"],d),e.prev=15,e.next=18,f.adventure_cellar(a,1);case 18:return p=e.sent,e.next=21,p.wait(2);case 21:1===e.sent.status?s(l):(v.ZP.dismiss(l),v.ZP.error("Transaction reverted"),n({error:!0,data:void 0})),e.next=31;break;case 25:e.prev=25,e.t0=e.catch(15),console.error(e.t0),v.ZP.dismiss(l),v.ZP.error("Something went wrong, please try again later."),n({error:e.t0,data:void 0});case 31:case"end":return e.stop()}}),e,null,[[15,25]])})))).apply(this,arguments)}function S(){return(S=(0,a.Z)(o().mark((function e(r,n){var t,a,s,i,c,u,l,d,f,p,x=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.provider,a=r.tokensID,s=x.length>2&&void 0!==x[2]?x[2]:P,e.next=4,w({provider:t,steps:2});case 4:if(i=e.sent,c=(0,k.Z)(i,2),u=c[0],c[1]){e.next=12;break}return v.ZP.error("Approve reverted"),n({error:!0,data:void 0}),e.abrupt("return");case 12:return l=u?v.ZP.loading("2/2 - Level up your adventurers..."):v.ZP.loading("Level up your adventurers..."),d=t.getSigner(),f=new C.Contract("0x67531697B81A1213f89899FD2e94f21C8ff4a172",["function level_up(uint[] memory _summoners) external"],d),e.prev=15,e.next=18,f.level_up(a);case 18:return p=e.sent,e.next=21,p.wait(2);case 21:1===e.sent.status?s(l):(v.ZP.dismiss(l),v.ZP.error("Transaction reverted"),n({error:!0,data:void 0})),e.next=31;break;case 25:e.prev=25,e.t0=e.catch(15),console.error(e.t0),v.ZP.dismiss(l),v.ZP.error("Something went wrong, please try again later."),n({error:e.t0,data:void 0});case 31:case"end":return e.stop()}}),e,null,[[15,25]])})))).apply(this,arguments)}function R(){return(R=(0,a.Z)(o().mark((function e(r,n){var t,a,s,i,c,u,l,d,f,p,x=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.provider,a=r.tokensID,s=x.length>2&&void 0!==x[2]?x[2]:P,e.next=4,w({provider:t,steps:2});case 4:if(i=e.sent,c=(0,k.Z)(i,2),u=c[0],c[1]){e.next=12;break}return v.ZP.error("Approve reverted"),n({error:!0,data:void 0}),e.abrupt("return");case 12:return l=u?v.ZP.loading("2/2 - Claiming gold for your adventurers..."):v.ZP.loading("Claiming gold for your adventurers..."),d=t.getSigner(),f=new C.Contract("0x67531697B81A1213f89899FD2e94f21C8ff4a172",["function claim_gold(uint[] memory _summoners) external"],d),e.prev=15,e.next=18,f.claim_gold(a);case 18:return p=e.sent,e.next=21,p.wait(2);case 21:1===e.sent.status?s(l):(v.ZP.dismiss(l),v.ZP.error("Transaction reverted"),n({error:!0,data:void 0})),e.next=31;break;case 25:e.prev=25,e.t0=e.catch(15),console.error(e.t0),v.ZP.dismiss(l),v.ZP.error("Something went wrong, please try again later."),n({error:e.t0,data:void 0});case 31:case"end":return e.stop()}}),e,null,[[15,25]])})))).apply(this,arguments)}var j=n(85893);function y(){var e=(0,d.useState)(0),r=e[0],n=e[1];return(0,j.jsx)("h1",{className:"text-xs md:text-xs leading-normal md:leading-8",children:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(m.Z,{onDone:function(){return n((function(e){return e+1}))},shouldStart:0===r,children:"HELLO THERE. I AM "}),(0,j.jsx)("span",{className:"text-tag-info dark:text-tag-warning",children:(0,j.jsx)(m.Z,{onDone:function(){return n((function(e){return e+1}))},shouldStart:1===r,children:"JANET"})}),(0,j.jsx)(m.Z,{onDone:function(){return n((function(e){return e+1}))},shouldStart:2===r,children:", I'LL HELP YOU COORDINATE YOUR PARTY OF HEROES. FREE OF CHARGE! THE TOWN PAYS ME. PLEASE "}),(0,j.jsx)("span",{className:"text-tag-info dark:text-tag-warning",children:(0,j.jsx)(m.Z,{onDone:function(){return n((function(e){return e+1}))},shouldStart:3===r,children:"SELECT THE ADVENTURERS"})}),(0,j.jsx)(m.Z,{onDone:function(){return n((function(e){return e+1}))},shouldStart:4===r,children:" YOU WANT TO TAKE CARE OF."})]})})}c().extend(l());var I=function(e){var r=e.rarities,n=(0,p.ZP)(),s=n.provider,i=n.chainTime,u=(0,x.ZP)(),l=u.rNonce,m=u.updateBatchRarity,k=Object.values(r),C=(0,d.useState)([]),P=C[0],w=C[1],T=(0,d.useState)({canAdventure:0,canClaimGold:0,canAdventureCellar:0,canLevelUp:0}),b=T[0],I=T[1];function F(){return _.apply(this,arguments)}function _(){return(_=(0,a.Z)(o().mark((function e(){var r,n,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==b.canAdventure||0!==b.canAdventureCellar||0!==b.canLevelUp||0!==b.canClaimGold){e.next=2;break}return e.abrupt("return");case 2:for(r=(0,Z.yo)(P,10),n=function(e){var n=r[e];D({provider:s,tokensID:n},(function(e){var r=e.error;return console.error(r)}),(function(e){m(n),v.ZP.dismiss(e),v.ZP.success("Transaction successful")}))},t=0;t<r.length;t++)n(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){if(0!==b.canAdventure)for(var e=(0,Z.yo)(P,10),r=function(r){var n=e[r];!function(e,r){L.apply(this,arguments)}({provider:s,tokensID:n},(function(e){var r=e.error;return console.error(r)}),(function(e){m(n),v.ZP.dismiss(e),v.ZP.success("Transaction successful")}))},n=0;n<e.length;n++)r(n)}function B(){if(0!==b.canAdventureCellar)for(var e=(0,Z.yo)(P,10),r=function(r){var n=e[r];!function(e,r){O.apply(this,arguments)}({provider:s,tokensID:n},(function(e){var r=e.error;return console.error(r)}),(function(e){m(n),v.ZP.dismiss(e),v.ZP.success("Transaction successful")}))},n=0;n<e.length;n++)r(n)}function H(){if(0!==b.canLevelUp)for(var e=(0,Z.yo)(P,10),r=function(r){var n=e[r];!function(e,r){S.apply(this,arguments)}({provider:s,tokensID:n},(function(e){var r=e.error;return console.error(r)}),(function(e){m(n),v.ZP.dismiss(e),v.ZP.success("Transaction successful")}))},n=0;n<e.length;n++)r(n)}function G(){if(0!==b.canClaimGold)for(var e=(0,Z.yo)(P,10),r=function(r){var n=e[r];!function(e,r){R.apply(this,arguments)}({provider:s,tokensID:n},(function(e){var r=e.error;if(r)return console.error(r)}),(function(e){m(n),v.ZP.dismiss(e),v.ZP.success("Transaction successful")}))},n=0;n<e.length;n++)r(n)}return(0,d.useEffect)((function(){for(var e=0,r=0,n=0,t=0,a=function(a){var s,o,u,l,d,f=k.find((function(e){return e.tokenID===P[a]}));(c()(new Date(1e3*f.log)).isBefore(c()(new Date(1e3*i)))&&e++,Number((null===f||void 0===f||null===(s=f.gold)||void 0===s?void 0:s.claimable)||0)>0&&t++,c()(new Date(1e3*(null===f||void 0===f||null===(o=f.dungeons)||void 0===o||null===(u=o.cellar)||void 0===u?void 0:u.log))).isBefore(c()(new Date(1e3*i))))&&(Number((null===f||void 0===f||null===(l=f.dungeons)||void 0===l||null===(d=l.cellar)||void 0===d?void 0:d.scout)||0)>=1&&r++);f.xp>=(0,N.x)(f.level)&&n++},s=0;s<P.length;s++)a(s);I({canAdventure:e,canClaimGold:t,canAdventureCellar:r,canLevelUp:n})}),[P.length,l]),(0,j.jsx)("section",{className:"max-w-full",children:(0,j.jsxs)("div",{className:"max-w-screen-lg w-full mx-auto",children:[(0,j.jsxs)("div",{className:"flex flex-col md:flex-row items-center mb-8 md:mb-8",children:[(0,j.jsx)("div",{className:"w-auto md:w-64 mr-0 md:mr-8",style:{minWidth:256},children:(0,j.jsx)(f.default,{src:"/avatar/janet.gif",loading:"eager",quality:100,width:256,height:256})}),(0,j.jsx)(h.Z,{className:"p-4",children:(0,j.jsx)(y,{})})]}),(0,j.jsxs)("div",{className:"mb-4",children:[(0,j.jsx)("p",{className:"mb-4 text-regular cursor-pointer",onClick:function(){P.length!==k.length?w(k.map((function(e){return e.tokenID}))):w([])},children:P.length!==k.length?"> SELECT ALL":"> UNSELECT ALL"}),(0,j.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-8 gap-y-0 md:gap-y-4",children:k.map((function(e){return(0,j.jsx)("div",{className:"w-full",children:(0,j.jsx)(E.Z,{onClick:function(){return w(P.includes(e.tokenID)?P.filter((function(r){return r!==e.tokenID})):[].concat((0,t.Z)(P),[e.tokenID]))},adventurer:e,rarityClass:A.Z[e.class],children:(0,j.jsx)("div",{className:"absolute right-4 top-4",children:(0,j.jsx)("div",{className:"rounded-full border-black dark:border-dark-100 border-2",children:(0,j.jsx)("div",{className:"rounded-full p-2 ".concat(P.includes(e.tokenID)?"bg-tag-info dark:bg-dark-100":"bg-transparent"," border-white dark:border-dark-600 border-2")})})})})},e.tokenID)}))})]}),(0,j.jsx)(g.Z,{options:0===P.length?[{label:"NO ADVENTURER SELECTED, PLEASE SELECT ONE OR MORE OF THEM",onClick:function(){return F()}}]:[{label:0===b.canAdventure&&0===b.canAdventureCellar&&0===b.canLevelUp&&0===b.canClaimGold?(0,j.jsx)(j.Fragment,{children:"YOUR ADVENTURERS ARE ALL RESTING"}):(0,j.jsx)(j.Fragment,{children:"TAKE CARE OF EVERYTHING (ADVENTURE, THE CELLAR, LEVELUP & CLAIM GOLD)"}),onClick:function(){return F()}},{label:0===b.canAdventure?(0,j.jsx)(j.Fragment,{children:"NOBODY CAN ADVENTURE RIGHT NOW"}):(0,j.jsxs)(j.Fragment,{children:["ONLY THE DAILY ADVENTURE ",(0,j.jsx)("span",{className:"text-tag-info dark:text-tag-warning",children:"(".concat(b.canAdventure," ADVENTURERS)")})]}),onClick:function(){return U()}},{label:0===b.canAdventureCellar?(0,j.jsx)(j.Fragment,{children:"NOBODY CAN GO IN THE CELLAR RIGHT NOW"}):(0,j.jsxs)(j.Fragment,{children:["ONLY THE CELLAR ",(0,j.jsx)("span",{className:"text-tag-info dark:text-tag-warning",children:"(".concat(b.canAdventureCellar," ADVENTURERS)")})]}),onClick:function(){return B()}},{label:0===b.canLevelUp?(0,j.jsx)(j.Fragment,{children:"NOBODY CAN LEVEL-UP RIGHT NOW"}):(0,j.jsxs)(j.Fragment,{children:["ONLY LEVEL-UP ",(0,j.jsx)("span",{className:"text-tag-info dark:text-tag-warning",children:"(".concat(b.canLevelUp," ADVENTURERS)")})]}),onClick:function(){return H()}},{label:0===b.canClaimGold?(0,j.jsx)(j.Fragment,{children:"NOBODY CAN CLAIM GOLD RIGHT NOW"}):(0,j.jsxs)(j.Fragment,{children:["ONLY CLAIM GOLD ",(0,j.jsx)("span",{className:"text-tag-info dark:text-tag-warning",children:"(".concat(b.canClaimGold," ADVENTURERS)")})]}),onClick:function(){return G()}}]}),(0,j.jsx)("div",{className:"-mt-4",children:(0,j.jsx)("i",{className:"text-megaxs text-opacity-40 text-black dark:text-dark-100",children:"TRANSACTIONS ARE PROCESSED IN BATCHES OF 10 ADVENTURERS BECAUSE OF THE BLOCK LIMIT"})})]})})}},61583:function(e,r,n){"use strict";function t(e){for(var r=1e3*e,n=1;n<e;n++)r+=1e3*n;return r}n.d(r,{x:function(){return t}})},73964:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/town/guild-house",function(){return n(80484)}])}},function(e){e.O(0,[774,888,179],(function(){return r=73964,e(e.s=r);var r}));var r=e.O();_N_E=r}]);